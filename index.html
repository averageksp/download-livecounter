<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Download Counter</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 50px;
        }
        .counter {
            font-size: 2em;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Mod Download Counter</h1>
    <p>Live download count for your mod:</p>
    <div id="download-counter" class="counter">
        Loading...
    </div>

    <script>
        async function fetchDownloadCounts() {
            const modName = "KerbalChecklists";
            const githubRepo = "averageksp/KerbalChecklists";
            const spacedockId = 3855;
            
            let githubDownloads = 0;
            let spacedockDownloads = 0;

            // Fetch GitHub download count
            try {
                const githubResponse = await fetch(`https://api.github.com/repos/${githubRepo}/releases`);
                const githubData = await githubResponse.json();
                githubDownloads = githubData.reduce((sum, release) => sum + (release.assets?.reduce((aSum, asset) => aSum + asset.download_count, 0) || 0), 0);
            } catch (e) {
                console.log("Error fetching GitHub data:", e);
            }

            // Fetch SpaceDock download count
            try {
                const spacedockResponse = await fetch(`https://spacedock.info/api/mod/${spacedockId}`);
                const spacedockData = await spacedockResponse.json();
                spacedockDownloads = spacedockData.downloads || 0;
            } catch (e) {
                console.log("Error fetching SpaceDock data:", e);
            }

            const totalDownloads = githubDownloads + spacedockDownloads;
            document.getElementById("download-counter").textContent = `Total Downloads: ${totalDownloads}`;
        }

        // Fetch the download counts on page load
        fetchDownloadCounts();
    </script>
</body>
</html>
